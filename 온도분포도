# Body Tip GUI 온도 분포도 분석 기능 개발 기록

## 날짜
2025년 10월 30일

## 작업 요약
기존 Body Tip GUI에 x축 좌표 기반 온도 분포도 분석 기능을 추가했습니다.

---

## 주요 추가 기능

### 1. 분석 모드 선택
- **트렌드 분석 (시간-온도)**: 기존 기능
- **온도 분포도 분석 (x축-온도)**: 새로운 기능

### 2. 온도 분포도 분석 기능
#### 2.1 단일 파일 분석
- Excel 파일의 "직선분석" 시트에서 데이터 읽기 (46행부터 시작)
- A열: x좌표 (px)
- B열: B영역 온도
- C열: C영역 온도
- B영역과 C영역을 체크박스로 선택하여 동시 표시 가능

#### 2.2 다중 파일 비교 분석
- **여러 파일 동시 추가**: 파일 선택 대화상자에서 여러 파일 선택 가능
- **영역 선택**: B영역 또는 C영역 중 하나를 선택하여 비교
- **ΔT 모드**: 
  - 0pulse 데이터를 기준으로 온도 차이 계산
  - 자동으로 0pulse 파일 감지
  - 수동으로 기준 파일 선택 가능

### 3. 좌표 변환 (px → mm)
- 기본 변환 비율: 10mm = 38px
- 사용자 설정 가능한 변환 비율
- "변환 적용" 버튼으로 실시간 변환
- 중복 적용 방지 (이전 변환을 되돌린 후 새 변환 적용)

### 4. 그래프 설정 기능
Configure Subplots 버튼 옆에 ⚙ (설정) 버튼 추가:
- **그래프 제목**: 텍스트 및 글자 크기
- **X축**: 레이블 텍스트, 레이블 크기, 눈금 숫자 크기
- **Y축**: 레이블 텍스트, 레이블 크기, 눈금 숫자 크기
- **범례**: 글자 크기, 위치 (best, upper right, upper left 등)
- **격자**: 표시 여부, 투명도

### 5. 축 범위 설정 기능
Zoom to rectangle 버튼 옆에 📐 (축 범위) 버튼 추가:
- X축 최소값/최대값 직접 입력
- Y축 최소값/최대값 직접 입력
- **적용**: 범위 적용하되 창은 열어둠 (여러 값 시도 가능)
- **원래 범위**: 초기값으로 되돌리기
- **확인**: 적용하고 창 닫기
- **취소**: 적용 안 하고 창 닫기

### 6. 마우스 휠 줌 기능
- 마우스 휠로 그래프 확대/축소
- 줌 범위: 원본 크기의 1% ~ 200%
- 마우스 위치 중심으로 줌

---

## 파일 구조

### 데이터 파일 위치
- 온도 분포도 데이터: `온도분포도/` 폴더
- 파일 명명 규칙: `바디팁_[타입]_[조건]_[펄스수]pulse.xlsx`
  - 예: `바디팁_tri_sn_9.5lv_7pulse.xlsx`

### Excel 파일 구조
- **시트명**: "직선분석"
- **데이터 시작 행**: 46행
- **열 구조**:
  - A열 (x좌표): X축 좌표 (px)
  - B열 (B영역_온도): B영역의 온도값
  - C열 (C영역_온도): C영역의 온도값

---

## 사용 방법

### 단일 파일 분석
1. "온도 분포도 분석 (x축-온도)" 모드 선택
2. "파일 열기" 버튼으로 Excel 파일 선택
3. B영역/C영역 체크박스로 표시할 영역 선택
4. 필요시 px → mm 변환 설정
5. 그래프 설정 및 축 범위 조정

### 다중 파일 비교
1. "온도 분포도 분석 (x축-온도)" 모드 선택
2. 비교할 영역 선택 (B영역 또는 C영역)
3. "파일 추가" 버튼으로 여러 파일 선택 (Ctrl+클릭으로 다중 선택)
4. ΔT 모드 필요시 체크 및 기준 파일 선택
5. "비교 분석" 버튼 클릭
6. 그래프 확인 및 조정

---

## 주요 코드 변경 사항

### 새로 추가된 메서드
- `switch_analysis_mode()`: 분석 모드 전환
- `load_distribution_data()`: 온도 분포도 데이터 로드
- `load_distribution_mode()`: 분포도 모드 데이터 처리
- `plot_distribution_graph()`: 분포도 그래프 그리기
- `update_distribution_graph()`: 그래프 업데이트
- `apply_coordinate_conversion()`: px → mm 좌표 변환
- `toggle_delta_t_mode()`: ΔT 모드 토글
- `update_reference_file_list()`: 기준 파일 목록 업데이트
- `compare_files_analysis()`: 다중 파일 비교 분석
- `setup_distribution_frame()`: 분포도 분석 UI 설정
- `setup_distribution_scroll_zoom()`: 마우스 휠 줌 설정
- `open_graph_settings()`: 그래프 설정 대화상자
- `open_axis_limit_dialog()`: 축 범위 설정 대화상자

### CustomNavigationToolbar 클래스
- NavigationToolbar2Tk 상속
- 커스텀 버튼 추가 (설정, 축 범위)
- 버튼 스타일 및 마우스오버 효과

---

## 개선 사항

### 버그 수정
- 좌표 변환 중복 적용 방지
- 대화상자 크기 조정으로 버튼 가시성 확보

### UX 개선
- 다중 파일 선택 지원
- ΔT 모드 자동 0pulse 감지
- 실시간 그래프 설정 미리보기
- 축 범위 여러 번 시도 가능

---

## 참고 사항
- 그래프 줌 제한: 원본의 1% ~ 200%
- 좌표 변환 기본값: 10mm = 38px
- ΔT 모드에서는 동일 x좌표끼리 온도 차이 계산

